<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Banana Split URI Parser</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.js"></script>
<script type="text/javascript" src="banana-split-uri-parser.js"></script>
<script type="text/javascript">
//<![CDATA[

$(function() {
  var uri = [
    '',
    '#hash',
    '?key',
    '?key#hash',
    '?key=value',
    '?key=value&key2=value2',
    '?key=value&amp;key2=value2',
    '?key=value?bad=bad&key2=value2',
    '?key=value&key2=value2#hash?asd',
    '?key=value&key2=value2#hash?asd#otherhash',
    '?key=value&amp;key2=value2',
    '#hash?key',
    'path',
    'path#hash',
    'path?key',
    'path?key#hash',
    'path#hash?key'
  ];
  var html = '';
  for (var i = 0; i < uri.length; i++) {
    var o = banana_split(uri[i]);
    html += 'uri: ' + uri[i];
    html += "\n" + 'o.path: ' + o.path;
    html += "\n" + 'o.hash: ' + o.hash;
    html += "\n" + 'o.query: ' + o.query;
    if (o.params === false) {
      html += "\n" + 'o.params: ' + o.params;
    }
    else {
      html += "\n" + 'o.params:';
      for (var j in o.params) {
        html += "\n" + j + '=' + o.params[j];
      }
    }
    html += "\n\n";
  }
  $('div.taster-test').append('<pre>'+html+'</pre>');
});

//]]>
</script>
</head>
<body>
<h1>Banana Split URI Parser</h1>
<p class="kwn"><strong>Given a banana (URI) the function will split it and return an ice-cream (object) made from its path, hash, query and params</strong></p>
<p>Created 2011 March 7. Modified 2011 March 8</p>
<pre>&lt;script type=&quot;text/javascript&quot;&gt;
//&lt;![CDATA[

  // Version 1.1.
  banana_split = function(uri) {
    var b,i,len,
    o = {params: {}, query: false},
    a = uri.split('#');
    b = a.shift().split('?');
    o.hash = a.join('#') || false;
    o.path = b.shift() || false;
    a = b.join('?').split('&amp;');
    if (a[0] !== '') {
      len = a.length;
      o.query = a[0];
      for (i = 0; i &lt; len; i++) {
        b = a[i].split('=');
        o.params[b.shift().replace(/^amp;/, '')] = (typeof b[0] === 'undefined') ? true: b.join('=');
      }
    }
    return o;
  };

//]]&gt;
&lt;/script&gt;</pre>
<p>If path, hash or query are empty false is returned. If params is empty an empty object is returned.</p>
<p>Feedback welcomed.</p>
<div class="taster-test">
<h2>Taster Test</h2>
<pre>&lt;script type=&quot;text/javascript&quot;&gt;
//&lt;![CDATA[

$(function() {
  var uri = [
    '',
    '#hash',
    '?key',
    '?key#hash',
    '?key=value',
    '?key=value&amp;key2=value2',
    '?key=value&amp;amp;key2=value2',
    '?key=value?bad=bad&amp;key2=value2',
    '?key=value&amp;key2=value2#hash?asd',
    '?key=value&amp;key2=value2#hash?asd#otherhash',
    '?key=value&amp;amp;key2=value2',
    '#hash?key',
    'path',
    'path#hash',
    'path?key',
    'path?key#hash',
    'path#hash?key'
  ];
  var html = '';
  for (var i = 0; i &lt; uri.length; i++) {
    var o = banana_split(uri[i]);
    html += 'uri: ' + uri[i];
    html += &quot;\n&quot; + 'o.path: ' + o.path;
    html += &quot;\n&quot; + 'o.hash: ' + o.hash;
    html += &quot;\n&quot; + 'o.query: ' + o.query;
    if (o.params === false) {
      html += &quot;\n&quot; + 'o.params: ' + o.params;
    }
    else {
      html += &quot;\n&quot; + 'o.params:';
      for (var j in o.params)
      {
        html += &quot;\n&quot; + j + '=' + o.params[j];
      }
    }
    html += &quot;\n\n&quot;;
  }
  $('div.taster-test').append('&lt;pre&gt;'+html+'&lt;/pre&gt;');
});

//]]&gt;
&lt;/script&gt;
</pre>
</div>
</body>
</html>
